<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Document</title>

    <script>
          function openAndRefresh(event, url) {
            // Prevent the default link behavior (navigation)
            event.preventDefault();

            // Open the link in a new tab
            window.open(url, '_blank'); // Opens the short URL in a new tab

            // Refresh the current page
            location.reload(); // Reload the current page
        }
    </script>
</head>
<body>
    <div class="container">
   <h1>URL Shrinkier</h1> 
   <form action="/shortUrls" method="post" class="my-4 form inline">
    <label for="fullUrl" class="sr-only">Full url</label>
    <input required placeholder="Url" type="url" name="fullUrl" id="fullUrl" class="form-control col mr-2">
    <button class="btn btn-success" type="submit">Shrink</button>
   </form>

   <table class="table table-striped table-responsive">
    <thead>
        <tr>
            <th>Full URL</th>
            <th>Short URL</th>
            <th>clicks</th>
        </tr>
    </thead>
    <tbody>
        <% shortUrls.forEach(shortUrl=>{ %>
            <tr>
                <td><a href="<%=shortUrl.full %>" target="_blank"><%= shortUrl.full %></a></td>
                <td><a onclick="openAndRefresh(event, '<%= shortUrl.short %>')" href="<%=shortUrl.short %>"  ><%= shortUrl.short %></a></td>
                <td><%=shortUrl.clicks %></td>
            </tr>
       <%   }) %>
      
    </tbody>
   </table>
</div>
</body>
</html>